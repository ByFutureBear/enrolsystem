@page
@model OnlineEnrolmentSystem.Pages.Enquiry.TimetableMatchingModel
@{
    ViewData["Title"] = "Timetable Matching";
}

<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-10">
            <div class="card shadow-lg border-0 rounded-3">
                <div class="card-header bg-info text-white text-center">
                    <h4>🗓️ Timetable Matching</h4>
                </div>
                <div class="card-body p-4">

                    @* Display validation errors *@
                    <div asp-validation-summary="All" class="text-danger mb-3"></div>

                    <form method="post" asp-page-handler="Check">
                        <div class="mb-3">
                            <label class="form-label fw-bold">Select Your Classes:</label>
                            <div class="row">
                                @foreach (var cls in Model.AllClasses)
                                {
                                    <div class="col-md-6 mb-2">
                                        <div class="form-check border p-2 rounded">
                                            <input type="checkbox"
                                                   class="form-check-input"
                                                   name="SelectedClassIds"
                                                   value="@cls.ClassId"
                                                   id="class-@cls.ClassId"
                                                   @(Model.SelectedClassIds.Contains(cls.ClassId) ? "checked" : "") />
                                            <label class="form-check-label" for="class-@cls.ClassId">
                                                <strong>@cls.Course.CourseCode</strong> - @cls.Course.CourseName <br />
                                                <small class="text-muted">Section: @cls.Section - @cls.Schedule</small>
                                            </label>
                                        </div>
                                    </div>
                                }
                            </div>
                        </div>

                        <div class="text-center mt-3">
                            <button type="submit" class="btn btn-info px-4">Check Timetable</button>
                        </div>
                    </form>

                    @* Show result after checking *@
                    @if (!string.IsNullOrEmpty(Model.MatchResult))
                    {
                        <div class="alert @(Model.MatchResult.Contains("No timetable conflicts") ? "alert-success" : "alert-danger") mt-4 fw-bold">
                            @Html.Raw(Model.MatchResult.Replace("\n", "<br/>"))
                        </div>
                    }

                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}